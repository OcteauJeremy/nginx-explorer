function ConvertJsonToTable(t,e,n,r){var o="<i>{0}</i>",a=e?' id="'+e+'"':"",s=n?' class="'+n+'"':"",l='<table border="1" cellpadding="1" cellspacing="1"'+a+s+">{0}{1}</table>",d="<thead>{0}</thead>",f="<tbody>{0}</tbody>",u="<tr>{0}</tr>",c="<th>{0}</th>",h="<td>{0}</td>",p="",m="",g="";if(t){var v,w="string"==typeof t[0];if(w)p+=c.format("value");else if("object"==typeof t[0])for(v=array_keys(t[0]),i=0;i<v.length;i++)p+=c.format(v[i]);if(d=d.format(u.format(p)),w)for(i=0;i<t.length;i++)m+=h.format(t[i]),g+=u.format(m),m="";else if(v)for(i=0;i<t.length;i++){for(j=0;j<v.length;j++){var b=t[i][v[j]];m+=h.format(b?b:o.format(b).toUpperCase())}g+=u.format(m),m=""}return f=f.format(g),l=l.format(d,f)}return null}function array_keys(t,e,n){var r="undefined"!=typeof e,o=[],a=!!n,i=!0,s="";if(t&&"object"==typeof t&&t.change_key_case)return t.keys(e,n);for(s in t)t.hasOwnProperty(s)&&(i=!0,r&&(a&&t[s]!==e?i=!1:t[s]!=e&&(i=!1)),i&&(o[o.length]=s));return o}function fileApp(t,e){loadJSON(t,function(n){formatData(t,n);var r=ConvertJsonToTable(n,"dataTable",null,null);e.innerHTML=r,new Tablesort(document.getElementById("dataTable"))},function(t){console.error(t)})}function formatData(t,e){e.forEach(function(e){var n="";n="directory"==e.type?'<a href="#" onclick=\'fileApp("'+t+e.name+"/\", this)'>"+e.name+"</a>":linkify(t,e.name);var r=new Date(e.mtime);r=[r.getDate().padLeft(),(r.getMonth()+1).padLeft(),r.getFullYear()].join("/")+" "+[r.getHours().padLeft(),r.getMinutes().padLeft(),r.getSeconds().padLeft()].join(":");var o="";e.size&&(o=humanFileSize(e.size,!1)),e.Filename=n,e.Size=o,e.Date=r,delete e.size,delete e.name,delete e.type,delete e.mtime})}function linkify(t,e){return'<a href="'+t+e+'">'+e+"</a>"}function humanFileSize(t,e){var n=e?1e3:1024;if(Math.abs(t)<n)return t+" B";var r=e?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],o=-1;do t/=n,++o;while(Math.abs(t)>=n&&o<r.length-1);return t.toFixed(1)+" "+r[o]}function loadJSON(t,e,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){r.readyState===XMLHttpRequest.DONE&&(r.status>=200&&r.status<400?e&&e(JSON.parse(r.responseText)):n&&n(r))},r.open("GET",t,!0),r.send()}String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,function(e,n){return"undefined"!=typeof t[n]?t[n]:"{"+n+"}"})},!function(){function t(t,e){if(!t||"TABLE"!==t.tagName)throw new Error("Element must be a table");this.init(t,e||{})}var e=[],n=function(t){var e;return window.CustomEvent&&"function"==typeof window.CustomEvent?e=new CustomEvent(t):(e=document.createEvent("CustomEvent"),e.initCustomEvent(t,!1,!1,void 0)),e},r=function(t){return t.getAttribute("data-sort")||t.textContent||t.innerText||""},o=function(t,e){return t=t.toLowerCase(),e=e.toLowerCase(),t===e?0:e>t?1:-1},a=function(t,e){return function(n,r){var o=t(n.td,r.td);return 0===o?e?r.index-n.index:n.index-r.index:o}};t.extend=function(t,n,r){if("function"!=typeof n||"function"!=typeof r)throw new Error("Pattern and sort must be a function");e.push({name:t,pattern:n,sort:r})},t.prototype={init:function(t,e){var n,r,o,a,i=this;if(i.table=t,i.thead=!1,i.options=e,t.rows&&t.rows.length>0&&(t.tHead&&t.tHead.rows.length>0?(n=t.tHead.rows[t.tHead.rows.length-1],i.thead=!0):n=t.rows[0]),n){var s=function(){i.current&&i.current!==this&&(i.current.classList.remove("sort-up"),i.current.classList.remove("sort-down")),i.current=this,i.sortTable(this)};for(o=0;o<n.cells.length;o++)a=n.cells[o],a.classList.contains("no-sort")||(a.classList.add("sort-header"),a.addEventListener("click",s,!1),a.classList.contains("sort-default")&&(r=a));r&&(i.current=r,i.sortTable(r))}},sortTable:function(t,i){var s=this,l=t.cellIndex,d=o,f="",u=[],c=s.thead?0:1,h=t.getAttribute("data-sort-method");if(s.table.dispatchEvent(n("beforeSort")),!(s.table.rows.length<2)){if(!h){for(;u.length<3&&c<s.table.tBodies[0].rows.length;)f=r(s.table.tBodies[0].rows[c].cells[l]),f=f.trim(),f.length>0&&u.push(f),c++;if(!u)return}for(c=0;c<e.length;c++)if(f=e[c],h){if(f.name===h){d=f.sort;break}}else if(u.every(f.pattern)){d=f.sort;break}s.col=l;var p,m,g=[],v={},w=0,b=0;for(c=0;c<s.table.tBodies.length;c++)for(p=0;p<s.table.tBodies[c].rows.length;p++)f=s.table.tBodies[c].rows[p],f.classList.contains("no-sort")?v[w]=f:g.push({tr:f,td:r(f.cells[s.col]),index:w}),w++;for(i?m=t.classList.contains("sort-up")?"sort-up":"sort-down":(m=t.classList.contains("sort-up")?"sort-down":t.classList.contains("sort-down")?"sort-up":s.options.descending?"sort-up":"sort-down",t.classList.remove("sort-down"===m?"sort-up":"sort-down"),t.classList.add(m)),"sort-down"===m?(g.sort(a(d,!0)),g.reverse()):g.sort(a(d,!1)),c=0;w>c;c++)v[c]?(f=v[c],b++):f=g[c-b].tr,s.table.tBodies[0].appendChild(f);s.table.dispatchEvent(n("afterSort"))}},refresh:function(){void 0!==this.current&&this.sortTable(this.current,!0)}},"undefined"!=typeof module&&module.exports?module.exports=t:window.Tablesort=t}(),window.onload=function(){var t=document.getElementById("filesapp");fileApp(t.dataset.api,t)},Number.prototype.padLeft=function(t,e){var n=String(t||10).length-String(this).length+1;return n>0?new Array(n).join(e||"0")+this:this};