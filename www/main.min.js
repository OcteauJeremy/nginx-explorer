function ConvertJsonToTable(e,t,n,a){var r="<i>{0}</i>",o=t?' id="'+t+'"':"",s=n?' class="'+n+'"':"",c='<table border="1" cellpadding="1" cellspacing="1"'+o+s+">{0}{1}</table>",l="<thead>{0}</thead>",p="<tbody>{0}</tbody>",d="<tr>{0}</tr>",f="<th>{0}</th>",u="<td>{0}</td>",m="",g="",x="";if(e){var h,v="string"==typeof e[0];if(v)m+=f.format("value");else if("object"==typeof e[0])for(h=array_keys(e[0]),i=0;i<h.length;i++)m+=f.format(h[i]);if(l=l.format(d.format(m)),v)for(i=0;i<e.length;i++)g+=u.format(e[i]),x+=d.format(g),g="";else if(h)for(i=0;i<e.length;i++){for(j=0;j<h.length;j++){var b=e[i][h[j]];g+=b?u.format(b):u.format(r.format(b).toUpperCase())}x+=d.format(g),g=""}return p=p.format(x),c=c.format(l,p)}return null}function array_keys(e,t,n){var i="undefined"!=typeof t,a=[],r=!!n,o=!0,s="";if(e&&"object"==typeof e&&e.change_key_case)return e.keys(t,n);for(s in e)e.hasOwnProperty(s)&&(o=!0,i&&(r&&e[s]!==t?o=!1:e[s]!=t&&(o=!1)),o&&(a[a.length]=s));return a}function fileApp(e){var t=fadeOut(filesapp,150);get(e).then(function(e){return JSON.parse(e)}).then(function(n){orderField(n);var i=ConvertJsonToTable(n,null,null,null),a=document.createElement("div");if(a.innerHTML=i,i.length>0){addSortInfo(a.getElementsByTagName("th")),addSortValue(a.getElementsByTagName("tbody")[0].getElementsByTagName("tr"),e),a.getElementsByTagName("thead")[0].getElementsByTagName("tr")[0].deleteCell(3);new Tablesort(a.getElementsByTagName("table")[0])}if(e!=filesapp.dataset.api){var r=e.lastIndexOf("/",e.length-2),o=e.lastIndexOf("/");e.substring(r+1,o)}t.then(function(e){return filesapp.innerHTML="",filesapp.appendChild(a),fadeIn(filesapp,150)})},function(e){console.error(e),filesapp.innerHTML='<h3 style="center;">An error occured</h3>'})}function orderField(e){e.forEach(function(e){var t=e.size;void 0===e.size&&(t="-"),e.Filename=e.name,e.Size=t.toString(),e.Date=e.mtime,e.Type=e.type,delete e.size,delete e.name,delete e.type,delete e.mtime})}function addSortInfo(e){e[0].setAttribute("data-sort-method","default"),e[1].setAttribute("data-sort-method","number"),e[2].setAttribute("data-sort-method","date"),e[2].className+="sort-default",e[3].setAttribute("data-sort-method","default")}function addSortValue(e,t){var n=new Date;[].forEach.call(e,function(e){var i=e.getElementsByTagName("td");formatNameField(i[0],i[3],t),formatSizeField(i[1]),formatDateField(i[2],n),e.deleteCell(3)})}function formatNameField(e,t,n){var i=e.innerHTML,a=t.innerHTML;e.setAttribute("data-sort",i),"directory"==a?e.innerHTML=directoryfy(n,i):e.innerHTML=linkify(n,i)}function formatSizeField(e){var t=e.innerHTML;e.setAttribute("data-sort","-"==t?"-":t),e.innerHTML="-"==t?"-":humanFileSize(parseInt(t),!1)}function formatDateField(e,t){var n=new Date(e.innerHTML);if(e.setAttribute("data-sort",n.toISOString()),t.getTime()-n.getTime()>1728e5)e.innerHTML=[n.getHours().padLeft(),n.getMinutes().padLeft(),n.getSeconds().padLeft()].join(":")+" "+[n.getDate().padLeft(),(n.getMonth()+1).padLeft(),n.getFullYear()].join("/");else if(t.getTime()-n.getTime()<6e4){var i=Math.round((t.getTime()-n.getTime())/1e3),a=1==i?"second":"seconds";e.innerHTML=[i.toString(),a,"ago"].join(" ")}else if(t.getTime()-n.getTime()<36e5){var r=Math.round((t.getTime()-n.getTime())/6e4),o=1==r?"minute":"minutes";e.innerHTML=[r.toString(),o,"ago"].join(" ")}else if(t.getTime()-n.getTime()<864e5){var s=Math.round((t.getTime()-n.getTime())/36e5),c=1==s?"hour":"hours";e.innerHTML=[s.toString(),c,"ago"].join(" ")}else e.innerHTML="Yesterday"}function directoryfy(e,t){return['<a href="javascript:void(0)" onclick=\'fileApp("',escapeHtml(e),escapeHtml(t),"/\")'>",iconFor(t,!0),t,"</a>"].join("")}function linkify(e,t){return['<a href="',escapeHtml(e),escapeHtml(t),'">',iconFor(t,!1),t,"</a>"].join("")}function iconFor(e,t){var n="<img src='/icons/{0}.svg' width=24 class='fileicon'>";if(t)return n.format("folder");var i=e.slice(e.lastIndexOf(".")+1),a="application-octet-stream";return void 0!==IconMap[i]&&(a=IconMap[i]),n.format(a)}function get(e){return new Promise(function(t,n){var i=new XMLHttpRequest;i.overrideMimeType("text/html; charset=ISO-8859-1"),i.onerror=function(){n(Error("Network Error"))},i.onreadystatechange=function(){i.readyState===XMLHttpRequest.DONE&&(i.status>=200&&i.status<400?t(i.responseText):n(i))},i.open("GET",e,!0),i.send()})}function escapeHtml(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}function humanFileSize(e,t){var n=t?1e3:1024;if(Math.abs(e)<n)return e+" B";var i=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],a=-1;do e/=n,++a;while(Math.abs(e)>=n&&a<i.length-1);return e.toFixed(1)+" "+i[a]}function fadeOut(e,t){return new Promise(function(n){e.style.opacity=1;var i=1,a=new Date;!function r(){var o=Math.min(1,(new Date-a)/t);i=1-o,1>o?(e.style.opacity=i,requestAnimationFrame(r)):n(e)}()})}function fadeIn(e,t){return new Promise(function(n){e.style.opacity=0;var i=0,a=new Date;!function r(){var o=Math.min(1,(new Date-a)/t);i=o,1>o?(e.style.opacity=i,requestAnimationFrame(r)):(e.style.opacity=1,n(e))}()})}String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:"{"+n+"}"})},!function(){function e(e,t){if(!e||"TABLE"!==e.tagName)throw new Error("Element must be a table");this.init(e,t||{})}var t=[],n=function(e){var t;return window.CustomEvent&&"function"==typeof window.CustomEvent?t=new CustomEvent(e):(t=document.createEvent("CustomEvent"),t.initCustomEvent(e,!1,!1,void 0)),t},i=function(e){return e.getAttribute("data-sort")||e.textContent||e.innerText||""},a=function(e,t){return e=e.toLowerCase(),t=t.toLowerCase(),e===t?0:t>e?1:-1},r=function(e,t){return function(n,i){var a=e(n.td,i.td);return 0===a?t?i.index-n.index:n.index-i.index:a}};e.extend=function(e,n,i){if("function"!=typeof n||"function"!=typeof i)throw new Error("Pattern and sort must be a function");t.push({name:e,pattern:n,sort:i})},e.prototype={init:function(e,t){var n,i,a,r,o=this;if(o.table=e,o.thead=!1,o.options=t,e.rows&&e.rows.length>0&&(e.tHead&&e.tHead.rows.length>0?(n=e.tHead.rows[e.tHead.rows.length-1],o.thead=!0):n=e.rows[0]),n){var s=function(){o.current&&o.current!==this&&(o.current.classList.remove("sort-up"),o.current.classList.remove("sort-down")),o.current=this,o.sortTable(this)};for(a=0;a<n.cells.length;a++)r=n.cells[a],r.classList.contains("no-sort")||(r.classList.add("sort-header"),r.addEventListener("click",s,!1),r.classList.contains("sort-default")&&(i=r));i&&(o.current=i,o.sortTable(i))}},sortTable:function(e,o){var s=this,c=e.cellIndex,l=a,p="",d=[],f=s.thead?0:1,u=e.getAttribute("data-sort-method");if(s.table.dispatchEvent(n("beforeSort")),!(s.table.rows.length<2)){if(!u){for(;d.length<3&&f<s.table.tBodies[0].rows.length;)p=i(s.table.tBodies[0].rows[f].cells[c]),p=p.trim(),p.length>0&&d.push(p),f++;if(!d)return}for(f=0;f<t.length;f++)if(p=t[f],u){if(p.name===u){l=p.sort;break}}else if(d.every(p.pattern)){l=p.sort;break}s.col=c;var m,g,x=[],h={},v=0,b=0;for(f=0;f<s.table.tBodies.length;f++)for(m=0;m<s.table.tBodies[f].rows.length;m++)p=s.table.tBodies[f].rows[m],p.classList.contains("no-sort")?h[v]=p:x.push({tr:p,td:i(p.cells[s.col]),index:v}),v++;for(o?g=e.classList.contains("sort-up")?"sort-up":"sort-down":(g=e.classList.contains("sort-up")?"sort-down":e.classList.contains("sort-down")?"sort-up":s.options.descending?"sort-up":"sort-down",e.classList.remove("sort-down"===g?"sort-up":"sort-down"),e.classList.add(g)),"sort-down"===g?(x.sort(r(l,!0)),x.reverse()):x.sort(r(l,!1)),f=0;v>f;f++)h[f]?(p=h[f],b++):p=x[f-b].tr,s.table.tBodies[0].appendChild(p);s.table.dispatchEvent(n("afterSort"))}},refresh:function(){void 0!==this.current&&this.sortTable(this.current,!0)}},"undefined"!=typeof module&&module.exports?module.exports=e:window.Tablesort=e}();var filesapp;window.onload=function(){filesapp=document.getElementById("filesapp"),fileApp(filesapp.dataset.api)},IconMap={"7z":"application-x-7z-compressed",aac:"audio-x-generic",apk:"android-package-archive",apng:"image-png",atom:"application-atom+xml",avi:"audio-x-generic",bash:"application-x-executable-script",bmp:"image-bmp",c:"text-x-csrc",cfg:"text-x-generic",coffee:"application-x-javascript",conf:"text-x-generic",cpp:"text-x-c++src",csh:"application-x-executable-script",css:"text-css",csv:"text-csv",db:"application-vnd.oasis.opendocument.database",deb:"application-x-deb",desktop:"application-x-desktop",doc:"x-office-document",docx:"x-office-document",eml:"message-rfc822",epub:"application-epub+zip",erb:"application-x-ruby",ex:"text-x-generic",exe:"application-x-executable",fla:"video-x-generic",flac:"audio-x-flac",flv:"video-x-generic",gif:"image-gif",gml:"text-xml",go:"text-x-generic",gpx:"text-xml",gz:"application-x-gzip",h:"text-x-chdr",hxx:"text-x-c++hdr",hs:"text-x-haskell",htm:"text-html",html:"text-html",ico:"image-x-ico",ini:"text-x-generic",iso:"application-x-cd-image",jar:"application-x-java-archive",java:"application-x-java",jpeg:"image-jpeg",jpg:"image-jpeg",js:"application-x-javascript",log:"text-x-generic",lua:"text-x-generic",m3u:"audio-x-generic",markdown:"text-x-generic",md:"text-x-generic",mkv:"video-x-matroska",mp3:"audio-x-mpeg",mp4:"video-mp4",odp:"x-office-presentation",ods:"x-office-spreadsheet",odt:"x-office-document",ogg:"audio-x-generic",otf:"application-x-font-otf",pdf:"application-pdf",pgp:"application-pgp",php:"application-x-php",pkg:"package-x-generic",pl:"application-x-perl",png:"image-png",ppt:"x-office-presentation",pptx:"x-office-presentation",psd:"image-x-psd",py:"text-x-generic",pyc:"application-x-python-bytecode",rar:"application-x-rar",rb:"application-x-ruby",rpm:"application-x-rpm",rtf:"text-rtf",sh:"application-x-executable-script",svg:"image-svg+xml-compressed",svgz:"image-svg+xml-compressed",swf:"application-x-shockwave-flash",tar:"application-x-tar",text:"text-x-generic",tiff:"image-tiff",ttf:"application-x-font-ttf",txt:"text-x-generic",wav:"audio-x-wav",webm:"video-webm",wmv:"video-x-wmv",xcf:"image-x-xcf",xhtml:"text-html",xls:"x-office-spreadsheet",xlsx:"x-office-spreadsheet",xml:"text-xml",xpi:"package-x-generic",xz:"application-x-lzma-compressed-tar",zip:"application-zip",zsh:"application-x-executable-script",opml:"text-xml"},function(){var e=function(e){return new Date(e).getTime()||-1};Tablesort.extend("date",function(t){return(-1!==t.search(/(Mon|Tue|Wed|Thu|Fri|Sat|Sun)\.?\,?\s*/i)||-1!==t.search(/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/)||-1!==t.search(/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)/i))&&!isNaN(e(t))},function(t,n){return e(t)-e(n)})}(),function(){var e=function(e){return e.replace(/[^\-?0-9.]/g,"")},t=function(e,t){return e=parseFloat(e),t=parseFloat(t),e=isNaN(e)?0:e,t=isNaN(t)?0:t,e-t};Tablesort.extend("number",function(e){return e.match(/^-?[£\x24Û¢´€]?\d+\s*([,\.]\d{0,2})/)||e.match(/^-?\d+\s*([,\.]\d{0,2})?[£\x24Û¢´€]/)||e.match(/^-?(\d)*-?([,\.]){0,1}-?(\d)+([E,e][\-+][\d]+)?%?$/)},function(n,i){return n=e(n),i=e(i),t(i,n)})}(),Number.prototype.padLeft=function(e,t){var n=String(e||10).length-String(this).length+1;return n>0?new Array(n).join(t||"0")+this:this},Date.prototype.toISOString||!function(){function e(e){return 10>e?"0"+e:e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}();