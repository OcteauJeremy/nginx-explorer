function ConvertJsonToTable(t,e,r,n){var o="<i>{0}</i>",a=e?' id="'+e+'"':"",s=r?' class="'+r+'"':"",u='<table border="1" cellpadding="1" cellspacing="1"'+a+s+">{0}{1}</table>",l="<thead>{0}</thead>",d="<tbody>{0}</tbody>",f="<tr>{0}</tr>",c="<th>{0}</th>",p="<td>{0}</td>",h="",m="",w="";if(t){var g,v="string"==typeof t[0];if(v)h+=c.format("value");else if("object"==typeof t[0])for(g=array_keys(t[0]),i=0;i<g.length;i++)h+=c.format(g[i]);if(l=l.format(f.format(h)),v)for(i=0;i<t.length;i++)m+=p.format(t[i]),w+=f.format(m),m="";else if(g)for(i=0;i<t.length;i++){for(j=0;j<g.length;j++){var b=t[i][g[j]];m+=p.format(b?b:o.format(b).toUpperCase())}w+=f.format(m),m=""}return d=d.format(w),u=u.format(l,d)}return null}function array_keys(t,e,r){var n="undefined"!=typeof e,o=[],a=!!r,i=!0,s="";if(t&&"object"==typeof t&&t.change_key_case)return t.keys(e,r);for(s in t)t.hasOwnProperty(s)&&(i=!0,n&&(a&&t[s]!==e?i=!1:t[s]!=e&&(i=!1)),i&&(o[o.length]=s));return o}function fileApp(t,e){loadJSON(t,function(r){formatData(t,r);var n=ConvertJsonToTable(r,null,null,null);e.innerHTML=n;var o=e.getElementsByTagName("th");addSortInfo(o);new Tablesort(e.getElementsByTagName("table")[0])},function(t){console.error(t)})}function addSortInfo(t){t[0].setAttribute("data-sort-method","default"),t[1].setAttribute("data-sort-method","filesize"),t[2].setAttribute("data-sort-method","date"),t[2].className+="sort-default"}function formatData(t,e){e.forEach(function(e){var r="";r="directory"==e.type?directoryfy(t,e.name):linkify(t,e.name);var n=new Date(e.mtime);n=[n.getDate().padLeft(),(n.getMonth()+1).padLeft(),n.getFullYear()].join("/")+" "+[n.getHours().padLeft(),n.getMinutes().padLeft(),n.getSeconds().padLeft()].join(":");var o="";e.size&&(o=humanFileSize(e.size,!1)),e.Filename=r,e.Size=o,e.Date=n,delete e.size,delete e.name,delete e.type,delete e.mtime})}function directoryfy(t,e){return'<a href="javascript:void(0)" onclick=\'fileApp("'+t+e+"/\", this)'>"+e+"</a>"}function linkify(t,e){return'<a href="'+t+e+'">'+e+"</a>"}function humanFileSize(t,e){var r=e?1e3:1024;if(Math.abs(t)<r)return t+" B";var n=e?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],o=-1;do t/=r,++o;while(Math.abs(t)>=r&&o<n.length-1);return t.toFixed(1)+" "+n[o]}function loadJSON(t,e,r){var n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(n.status>=200&&n.status<400?e&&e(JSON.parse(n.responseText)):r&&r(n))},n.open("GET",t,!0),n.send()}String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,function(e,r){return"undefined"!=typeof t[r]?t[r]:"{"+r+"}"})},!function(){function t(t,e){if(!t||"TABLE"!==t.tagName)throw new Error("Element must be a table");this.init(t,e||{})}var e=[],r=function(t){var e;return window.CustomEvent&&"function"==typeof window.CustomEvent?e=new CustomEvent(t):(e=document.createEvent("CustomEvent"),e.initCustomEvent(t,!1,!1,void 0)),e},n=function(t){return t.getAttribute("data-sort")||t.textContent||t.innerText||""},o=function(t,e){return t=t.toLowerCase(),e=e.toLowerCase(),t===e?0:e>t?1:-1},a=function(t,e){return function(r,n){var o=t(r.td,n.td);return 0===o?e?n.index-r.index:r.index-n.index:o}};t.extend=function(t,r,n){if("function"!=typeof r||"function"!=typeof n)throw new Error("Pattern and sort must be a function");e.push({name:t,pattern:r,sort:n})},t.prototype={init:function(t,e){var r,n,o,a,i=this;if(i.table=t,i.thead=!1,i.options=e,t.rows&&t.rows.length>0&&(t.tHead&&t.tHead.rows.length>0?(r=t.tHead.rows[t.tHead.rows.length-1],i.thead=!0):r=t.rows[0]),r){var s=function(){i.current&&i.current!==this&&(i.current.classList.remove("sort-up"),i.current.classList.remove("sort-down")),i.current=this,i.sortTable(this)};for(o=0;o<r.cells.length;o++)a=r.cells[o],a.classList.contains("no-sort")||(a.classList.add("sort-header"),a.addEventListener("click",s,!1),a.classList.contains("sort-default")&&(n=a));n&&(i.current=n,i.sortTable(n))}},sortTable:function(t,i){var s=this,u=t.cellIndex,l=o,d="",f=[],c=s.thead?0:1,p=t.getAttribute("data-sort-method");if(s.table.dispatchEvent(r("beforeSort")),!(s.table.rows.length<2)){if(!p){for(;f.length<3&&c<s.table.tBodies[0].rows.length;)d=n(s.table.tBodies[0].rows[c].cells[u]),d=d.trim(),d.length>0&&f.push(d),c++;if(!f)return}for(c=0;c<e.length;c++)if(d=e[c],p){if(d.name===p){l=d.sort;break}}else if(f.every(d.pattern)){l=d.sort;break}s.col=u;var h,m,w=[],g={},v=0,b=0;for(c=0;c<s.table.tBodies.length;c++)for(h=0;h<s.table.tBodies[c].rows.length;h++)d=s.table.tBodies[c].rows[h],d.classList.contains("no-sort")?g[v]=d:w.push({tr:d,td:n(d.cells[s.col]),index:v}),v++;for(i?m=t.classList.contains("sort-up")?"sort-up":"sort-down":(m=t.classList.contains("sort-up")?"sort-down":t.classList.contains("sort-down")?"sort-up":s.options.descending?"sort-up":"sort-down",t.classList.remove("sort-down"===m?"sort-up":"sort-down"),t.classList.add(m)),"sort-down"===m?(w.sort(a(l,!0)),w.reverse()):w.sort(a(l,!1)),c=0;v>c;c++)g[c]?(d=g[c],b++):d=w[c-b].tr,s.table.tBodies[0].appendChild(d);s.table.dispatchEvent(r("afterSort"))}},refresh:function(){void 0!==this.current&&this.sortTable(this.current,!0)}},"undefined"!=typeof module&&module.exports?module.exports=t:window.Tablesort=t}(),window.onload=function(){var t=document.getElementById("filesapp");fileApp(t.dataset.api,t)},Number.prototype.padLeft=function(t,e){var r=String(t||10).length-String(this).length+1;return r>0?new Array(r).join(e||"0")+this:this},function(){var t=function(t){t=t.replace(/\-/g,"/"),t=t.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3");var e=t.split(" "),r=e[1].split(":"),n=e[0].split("/");return new Date(n[2],n[1]-1,n[0],r[0],r[1],r[2]).getTime()||-1};Tablesort.extend("date",function(e){return(-1!==e.search(/(Mon|Tue|Wed|Thu|Fri|Sat|Sun)\.?\,?\s*/i)||-1!==e.search(/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/)||-1!==e.search(/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)/i))&&!isNaN(t(e))},function(e,r){return e=e.toLowerCase(),r=r.toLowerCase(),t(e)-t(r)})}(),function(){var t=function(t,e){return t=parseFloat(t),e=parseFloat(e),t=isNaN(t)?0:t,e=isNaN(e)?0:e,t-e},e=function(t){return t.replace(/[^\-?0-9.]/g,"")},r=function(t){var r=t.match(/^(\d+(\.\d+)?) ?((K|M|G|T|P|E|Z|Y|B$)i?B?)$/i),o=parseFloat(e(r[1])),a=r[3];return o*n(a)},n=function(t){t=t.toLowerCase();var e="i"===t[1]?1024:1e3;switch(t[0]){case"b":return Math.pow(e,1);case"k":return Math.pow(e,2);case"m":return Math.pow(e,3);case"g":return Math.pow(e,4);case"t":return Math.pow(e,5);case"p":return Math.pow(e,6);case"e":return Math.pow(e,7);case"z":return Math.pow(e,8);case"y":return Math.pow(e,9);default:return e}};Tablesort.extend("filesize",function(t){return/^\d+(\.\d+)? ?(K|M|G|T|P|E|Z|Y|B$)i?B?$/i.test(t)},function(e,n){return e=""==e?"0 B":e,n=""==n?"0 B":n,e=r(e),n=r(n),t(n,e)})}();