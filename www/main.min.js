function ConvertJsonToTable(t,e,n,a){var r="<i>{0}</i>",o=e?' id="'+e+'"':"",s=n?' class="'+n+'"':"",c='<table border="1" cellpadding="1" cellspacing="1"'+o+s+">{0}{1}</table>",l="<thead>{0}</thead>",p="<tbody>{0}</tbody>",d="<tr>{0}</tr>",f="<th>{0}</th>",u="<td>{0}</td>",m="",x="",g="";if(t){var h,v="string"==typeof t[0];if(v)m+=f.format("value");else if("object"==typeof t[0])for(h=array_keys(t[0]),i=0;i<h.length;i++)m+=f.format(h[i]);if(l=l.format(d.format(m)),v)for(i=0;i<t.length;i++)x+=u.format(t[i]),g+=d.format(x),x="";else if(h)for(i=0;i<t.length;i++){for(j=0;j<h.length;j++){var b=t[i][h[j]];x+=b?u.format(b):u.format(r.format(b).toUpperCase())}g+=d.format(x),x=""}return p=p.format(g),c=c.format(l,p)}return null}function array_keys(t,e,n){var a="undefined"!=typeof e,i=[],r=!!n,o=!0,s="";if(t&&"object"==typeof t&&t.change_key_case)return t.keys(e,n);for(s in t)t.hasOwnProperty(s)&&(o=!0,a&&(r&&t[s]!==e?o=!1:t[s]!=e&&(o=!1)),o&&(i[i.length]=s));return i}function fileApp(t){var e=fadeOut(filesapp,150);get(t).then(function(t){return JSON.parse(t)}).then(function(n){orderField(n);var a=ConvertJsonToTable(n,null,null,null),i=document.createElement("div");if(i.innerHTML=a,a.length>0){addSortInfo(i.getElementsByTagName("th")),addSortValue(i.getElementsByTagName("tbody")[0].getElementsByTagName("tr"),t),i.getElementsByTagName("thead")[0].getElementsByTagName("tr")[0].deleteCell(3);new Tablesort(i.getElementsByTagName("table")[0])}if(t!=filesapp.dataset.api){var r=t.lastIndexOf("/",t.length-2),o=t.lastIndexOf("/");t.substring(r+1,o)}e.then(function(t){return filesapp.innerHTML="",filesapp.appendChild(i),fadeIn(filesapp,150)})},function(t){console.error(t),filesapp.innerHTML='<h3 style="center;">An error occured</h3>'})}function orderField(t){t.forEach(function(t){var e=t.size;void 0===t.size&&(e="-"),t.Filename=t.name,t.Size=e.toString(),t.Date=t.mtime,t.Type=t.type,delete t.size,delete t.name,delete t.type,delete t.mtime})}function addSortInfo(t){t[0].setAttribute("data-sort-method","default"),t[1].setAttribute("data-sort-method","number"),t[2].setAttribute("data-sort-method","date"),t[2].className+="sort-default",t[3].setAttribute("data-sort-method","default")}function addSortValue(t,e){[].forEach.call(t,function(t){var n=t.getElementsByTagName("td");formatNameField(n[0],n[3],e),formatSizeField(n[1]),formatDateField(n[2]),t.deleteCell(3)})}function formatNameField(t,e,n){var a=t.innerHTML,i=e.innerHTML;t.setAttribute("data-sort",a),"directory"==i?t.innerHTML=directoryfy(n,a):t.innerHTML=linkify(n,a)}function formatSizeField(t){var e=t.innerHTML;t.setAttribute("data-sort","-"==e?"-":e),t.innerHTML="-"==e?"-":humanFileSize(parseInt(e),!1)}function formatDateField(t){var e=new Date(t.innerHTML);t.setAttribute("data-sort",e.toISOString());var n=e;t.innerHTML=[n.getHours().padLeft(),n.getMinutes().padLeft(),n.getSeconds().padLeft()].join(":")+" "+[n.getDate().padLeft(),(n.getMonth()+1).padLeft(),n.getFullYear()].join("/")}function directoryfy(t,e){return['<a href="javascript:void(0)" onclick=\'fileApp("',escapeHtml(t),escapeHtml(e),"/\")'>",iconFor(e,!0),e,"</a>"].join("")}function linkify(t,e){return['<a href="',escapeHtml(t),escapeHtml(e),'">',iconFor(e,!1),e,"</a>"].join("")}function iconFor(t,e){var n="<img src='/icons/{0}.svg' width=24 class='fileicon'>";if(e)return n.format("folder");var a=t.slice(t.lastIndexOf(".")+1),i="application-octet-stream";return void 0!==IconMap[a]&&(i=IconMap[a]),n.format(i)}function get(t){return new Promise(function(e,n){var a=new XMLHttpRequest;a.overrideMimeType("text/html; charset=ISO-8859-1"),a.onerror=function(){n(Error("Network Error"))},a.onreadystatechange=function(){a.readyState===XMLHttpRequest.DONE&&(a.status>=200&&a.status<400?e(a.responseText):n(a))},a.open("GET",t,!0),a.send()})}function escapeHtml(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,function(t){return e[t]})}function humanFileSize(t,e){var n=e?1e3:1024;if(Math.abs(t)<n)return t+" B";var a=e?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],i=-1;do t/=n,++i;while(Math.abs(t)>=n&&i<a.length-1);return t.toFixed(1)+" "+a[i]}function fadeOut(t,e){return new Promise(function(n){t.style.opacity=1;var a=1,i=new Date;!function r(){var o=Math.min(1,(new Date-i)/e);a=1-o,1>o?(t.style.opacity=a,requestAnimationFrame(r)):n(t)}()})}function fadeIn(t,e){return new Promise(function(n){t.style.opacity=0;var a=0,i=new Date;!function r(){var o=Math.min(1,(new Date-i)/e);a=o,1>o?(t.style.opacity=a,requestAnimationFrame(r)):(t.style.opacity=1,n(t))}()})}String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,function(e,n){return"undefined"!=typeof t[n]?t[n]:"{"+n+"}"})},!function(){function t(t,e){if(!t||"TABLE"!==t.tagName)throw new Error("Element must be a table");this.init(t,e||{})}var e=[],n=function(t){var e;return window.CustomEvent&&"function"==typeof window.CustomEvent?e=new CustomEvent(t):(e=document.createEvent("CustomEvent"),e.initCustomEvent(t,!1,!1,void 0)),e},a=function(t){return t.getAttribute("data-sort")||t.textContent||t.innerText||""},i=function(t,e){return t=t.toLowerCase(),e=e.toLowerCase(),t===e?0:e>t?1:-1},r=function(t,e){return function(n,a){var i=t(n.td,a.td);return 0===i?e?a.index-n.index:n.index-a.index:i}};t.extend=function(t,n,a){if("function"!=typeof n||"function"!=typeof a)throw new Error("Pattern and sort must be a function");e.push({name:t,pattern:n,sort:a})},t.prototype={init:function(t,e){var n,a,i,r,o=this;if(o.table=t,o.thead=!1,o.options=e,t.rows&&t.rows.length>0&&(t.tHead&&t.tHead.rows.length>0?(n=t.tHead.rows[t.tHead.rows.length-1],o.thead=!0):n=t.rows[0]),n){var s=function(){o.current&&o.current!==this&&(o.current.classList.remove("sort-up"),o.current.classList.remove("sort-down")),o.current=this,o.sortTable(this)};for(i=0;i<n.cells.length;i++)r=n.cells[i],r.classList.contains("no-sort")||(r.classList.add("sort-header"),r.addEventListener("click",s,!1),r.classList.contains("sort-default")&&(a=r));a&&(o.current=a,o.sortTable(a))}},sortTable:function(t,o){var s=this,c=t.cellIndex,l=i,p="",d=[],f=s.thead?0:1,u=t.getAttribute("data-sort-method");if(s.table.dispatchEvent(n("beforeSort")),!(s.table.rows.length<2)){if(!u){for(;d.length<3&&f<s.table.tBodies[0].rows.length;)p=a(s.table.tBodies[0].rows[f].cells[c]),p=p.trim(),p.length>0&&d.push(p),f++;if(!d)return}for(f=0;f<e.length;f++)if(p=e[f],u){if(p.name===u){l=p.sort;break}}else if(d.every(p.pattern)){l=p.sort;break}s.col=c;var m,x,g=[],h={},v=0,b=0;for(f=0;f<s.table.tBodies.length;f++)for(m=0;m<s.table.tBodies[f].rows.length;m++)p=s.table.tBodies[f].rows[m],p.classList.contains("no-sort")?h[v]=p:g.push({tr:p,td:a(p.cells[s.col]),index:v}),v++;for(o?x=t.classList.contains("sort-up")?"sort-up":"sort-down":(x=t.classList.contains("sort-up")?"sort-down":t.classList.contains("sort-down")?"sort-up":s.options.descending?"sort-up":"sort-down",t.classList.remove("sort-down"===x?"sort-up":"sort-down"),t.classList.add(x)),"sort-down"===x?(g.sort(r(l,!0)),g.reverse()):g.sort(r(l,!1)),f=0;v>f;f++)h[f]?(p=h[f],b++):p=g[f-b].tr,s.table.tBodies[0].appendChild(p);s.table.dispatchEvent(n("afterSort"))}},refresh:function(){void 0!==this.current&&this.sortTable(this.current,!0)}},"undefined"!=typeof module&&module.exports?module.exports=t:window.Tablesort=t}();var filesapp;window.onload=function(){filesapp=document.getElementById("filesapp"),fileApp(filesapp.dataset.api)},IconMap={"7z":"application-x-7z-compressed",aac:"audio-x-generic",apk:"android-package-archive",apng:"image-png",atom:"application-atom+xml",avi:"audio-x-generic",bash:"application-x-executable-script",bmp:"image-bmp",c:"text-x-csrc",cfg:"text-x-generic",coffee:"application-x-javascript",conf:"text-x-generic",cpp:"text-x-c++src",csh:"application-x-executable-script",css:"text-css",csv:"text-csv",db:"application-vnd.oasis.opendocument.database",deb:"application-x-deb",desktop:"application-x-desktop",doc:"x-office-document",docx:"x-office-document",eml:"message-rfc822",epub:"application-epub+zip",erb:"application-x-ruby",ex:"text-x-generic",exe:"application-x-executable",fla:"video-x-generic",flac:"audio-x-flac",flv:"video-x-generic",gif:"image-gif",gml:"text-xml",go:"text-x-generic",gpx:"text-xml",gz:"application-x-gzip",h:"text-x-chdr",hxx:"text-x-c++hdr",hs:"text-x-haskell",htm:"text-html",html:"text-html",ico:"image-x-ico",ini:"text-x-generic",iso:"application-x-cd-image",jar:"application-x-java-archive",java:"application-x-java",jpeg:"image-jpeg",jpg:"image-jpeg",js:"application-x-javascript",log:"text-x-generic",lua:"text-x-generic",m3u:"audio-x-generic",markdown:"text-x-generic",md:"text-x-generic",mkv:"video-x-matroska",mp3:"audio-x-mpeg",mp4:"video-mp4",odp:"x-office-presentation",ods:"x-office-spreadsheet",odt:"x-office-document",ogg:"audio-x-generic",otf:"application-x-font-otf",pdf:"application-pdf",pgp:"application-pgp",php:"application-x-php",pkg:"package-x-generic",pl:"application-x-perl",png:"image-png",ppt:"x-office-presentation",pptx:"x-office-presentation",psd:"image-x-psd",py:"text-x-generic",pyc:"application-x-python-bytecode",rar:"application-x-rar",rb:"application-x-ruby",rpm:"application-x-rpm",rtf:"text-rtf",sh:"application-x-executable-script",svg:"image-svg+xml-compressed",svgz:"image-svg+xml-compressed",swf:"application-x-shockwave-flash",tar:"application-x-tar",text:"text-x-generic",tiff:"image-tiff",ttf:"application-x-font-ttf",txt:"text-x-generic",wav:"audio-x-wav",webm:"video-webm",wmv:"video-x-wmv",xcf:"image-x-xcf",xhtml:"text-html",xls:"x-office-spreadsheet",xlsx:"x-office-spreadsheet",xml:"text-xml",xpi:"package-x-generic",xz:"application-x-lzma-compressed-tar",zip:"application-zip",zsh:"application-x-executable-script",opml:"text-xml"},function(){var t=function(t){return new Date(t).getTime()||-1};Tablesort.extend("date",function(e){return(-1!==e.search(/(Mon|Tue|Wed|Thu|Fri|Sat|Sun)\.?\,?\s*/i)||-1!==e.search(/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/)||-1!==e.search(/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)/i))&&!isNaN(t(e))},function(e,n){return t(e)-t(n)})}(),function(){var t=function(t){return t.replace(/[^\-?0-9.]/g,"")},e=function(t,e){return t=parseFloat(t),e=parseFloat(e),t=isNaN(t)?0:t,e=isNaN(e)?0:e,t-e};Tablesort.extend("number",function(t){return t.match(/^-?[£\x24Û¢´€]?\d+\s*([,\.]\d{0,2})/)||t.match(/^-?\d+\s*([,\.]\d{0,2})?[£\x24Û¢´€]/)||t.match(/^-?(\d)*-?([,\.]){0,1}-?(\d)+([E,e][\-+][\d]+)?%?$/)},function(n,a){return n=t(n),a=t(a),e(a,n)})}(),Number.prototype.padLeft=function(t,e){var n=String(t||10).length-String(this).length+1;return n>0?new Array(n).join(e||"0")+this:this},Date.prototype.toISOString||!function(){function t(t){return 10>t?"0"+t:t}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+t(this.getUTCMonth()+1)+"-"+t(this.getUTCDate())+"T"+t(this.getUTCHours())+":"+t(this.getUTCMinutes())+":"+t(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}();